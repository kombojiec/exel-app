(()=>{"use strict";var t={246:(t,e,n)=>{t.exports=n.p+"14327f6445b002e9cb9c.svg"},233:(t,e,n)=>{t.exports=n.p+"e8005789d60bc74c51fa.svg"},774:(t,e,n)=>{t.exports=n.p+"fdcd9ff86c6cced25f38.svg"},78:(t,e,n)=>{t.exports=n.p+"d39ad5e14014b34f4b7c.svg"},569:(t,e,n)=>{t.exports=n.p+"5a4b228420e06eb0fb9b.svg"},57:(t,e,n)=>{t.exports=n.p+"0b8e8affb9fd981d965d.svg"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.p="",(()=>{function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var e=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this._element="string"==typeof t?document.querySelector(t):t,this.data=this._element.dataset,this.id=this._element.dataset.id}var n,o;return n=e,(o=[{key:"html",value:function(t){return"string"==typeof t?(this._element.innerHTML=t,this):this._element.outerHTML.trim()}},{key:"textContent",value:function(t){return"string"==typeof t?(this._element.textContent=t,this):"INPUT"==this._element.tagName?this._element.value.trim():this._element.textContent.trim()}},{key:"findElement",value:function(t){return r(this._element.querySelector(t))}},{key:"findAll",value:function(t){var e=[];return Array.from(this._element.querySelectorAll(t)).forEach((function(t){e.push(t)})),e}},{key:"addClass",value:function(t){return this._element.classList.add(t),this}},{key:"removeClass",value:function(t){return this._element.classList.remove(t),this}},{key:"css",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(e).forEach((function(n){t._element.style[n]=e[n]}))}},{key:"getStyles",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,n){return e[n]=t._element.style[n],e}),{})}},{key:"focus",value:function(){return this._element.focus(),this}},{key:"clear",value:function(){return this.html(""),this}},{key:"on",value:function(t,e){this._element.addEventListener(t,e)}},{key:"off",value:function(t,e){this._element.removeEventListener(t,e)}},{key:"append",value:function(t){return t instanceof e&&(t=t._element),this._element.append(t),this}}])&&t(n.prototype,o),e}();function r(t){return new e(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}r.create=function(t,e){var n=document.createElement(t);return n.className=e||"",r(n)};var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._listeners={}}var e,n;return e=t,(n=[{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this._listeners[t]&&this._listeners[t].forEach((function(t){t.apply(void 0,n)}))}},{key:"subscribe",value:function(t,e){var n=this;return this._listeners[t]=this._listeners[t]||[],this._listeners[t].push(e),function(){n._listeners[t]=n._listeners[t].filter((function(t){return t!=e}))}}}])&&o(e.prototype,n),t}(),c={textAlign:"left",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"};function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var u=function(t){return"string"!=typeof t?"":t.charAt(0).toUpperCase()+t.slice(1)};function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return JSON.parse(localStorage.getItem(t));localStorage.setItem(t,JSON.stringify(e))}function s(t){return t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(t).map((function(e){return"".concat(s(e),": ").concat(t[e])})).join(";")}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.store=e,this.sub=null,this.prevState={}}var e,n;return e=t,(n=[{key:"subscribeComponents",value:function(t){var e=this;this.prevState=this.store.getState(),this.sub=this.store.subscribe((function(n){Object.keys(n).forEach((function(r){var o,i;o=e.prevState[r],i=n[r],"object"===a(o)&&a(i),JSON.stringify(o)!==JSON.stringify(i)&&t.forEach((function(t){if(t.isWatching(r)){var e=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},r,n[r]);t.storeChanged(e)}}))})),e.prevState=e.store.getState()}))}},{key:"unsubscribeFromStore",value:function(){this.sub.unsubscribe()}}])&&p(e.prototype,n),t}();function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._element=r(e),this._components=n.components||[],this._observer=new i,this._store=n.store,this._tableState=n._tableState,this._subscriber=new y(this._store)}var e,n;return e=t,(n=[{key:"getRoot",value:function(){var t=r.create("div","exel"),e={observer:this._observer,store:this._store};return this._components=this._components.map((function(n){var o=r.create("div",n.className),i=new n(o,e);return o.html(i.toHTML()),t.append(o),i})),t}},{key:"render",value:function(){this._element.append(this.getRoot()),this._subscriber.subscribeComponents(this._components),this._components.forEach((function(t){t.init()}))}},{key:"destroy",value:function(){this._subscriber.unsubscribeFromStore(),this._components.forEach((function(t){return t.destroy()}))}}])&&b(e.prototype,n),t}(),v=n(246),d=n(233),m=n(57),g=n(774),_=n(78),O=n(569),w=function(){document.getElementById("bold").style.background=" center / 50% no-repeat url(".concat(v,")"),document.getElementById("italic").style.background=" center / 50% no-repeat url(".concat(d,")"),document.getElementById("underline").style.background=" center / 50% no-repeat url(".concat(m,")"),document.getElementById("left").style.background=" center / 50% no-repeat url(".concat(_,")"),document.getElementById("center").style.background=" center / 50% no-repeat url(".concat(g,")"),document.getElementById("right").style.background=" center / 50% no-repeat url(".concat(O,")")};function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var k=function(){function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e)throw new Error("No root provided to DomListener");this._root=e,this._name=n.name,this._listeners=n.listeners||[],this._observer=n.observer}var e,n;return e=t,(n=[{key:"initDOMListeners",value:function(){var t=this;this._listeners.forEach((function(e){var n=j(u(e));if(!t[n])throw new Error("No method ".concat(n," in ").concat(t._name," Component"));t[n]=t[n].bind(t),t._root.on(e,t[n])}))}},{key:"removeDomListeners",value:function(){var t=this;this._listeners.forEach((function(e){var n=j(u(e));t._root.off(e,t[n])}))}}])&&S(e.prototype,n),t}(),j=function(t){return"on"+t};function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function C(t,e){return(C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function T(t,e){return!e||"object"!==P(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function R(t){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(c,t);var e,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=R(r);if(o){var n=R(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return T(this,t)});function c(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return E(this,c),(e=i.call(this,t,n)).prepare(),e.observer=n.options.observer,e._unsubscribes=[],e.store=n.options.store,e.subscribe=n.subscribe||[],e}return e=c,(n=[{key:"prepare",value:function(){}},{key:"storeChanged",value:function(){}},{key:"isWatching",value:function(t){return this.subscribe.includes(t)}},{key:"emit",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.observer).emit.apply(e,[t].concat(r))}},{key:"on",value:function(t,e){var n=this.observer.subscribe(t,e);this._unsubscribes.push(n)}},{key:"dispatch",value:function(t){this.storeSubscribe=this.store.dispatch(t)}},{key:"toHTML",value:function(){return""}},{key:"init",value:function(){this.initDOMListeners()}},{key:"destroy",value:function(){this.removeDomListeners(),this._unsubscribes.forEach((function(t){return t()}))}}])&&x(e.prototype,n),c}(k);function D(t){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function B(t,e){return!e||"object"!==D(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var H,M,z,J=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(c,t);var e,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=I(r);if(o){var n=I(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return B(this,t)});function c(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),i.call(this,t,{name:"Header",listeners:[],options:e})}return e=c,(n=[{key:"toHTML",value:function(){return'\n    <input type="text" class="header__input" value="Новая таблица">\n    <div class="header__buttons">\n      <button class="button header-button">Удалить</button>\n      <button class="button header-button">Выйти</button>\n    </div>\n    '}}])&&N(e.prototype,n),c}(A);function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function K(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){G(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function G(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function F(t,e){return(F=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function X(t,e){return!e||"object"!==q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Z(t){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function V(t,e){return(V=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function tt(t,e){return!e||"object"!==$(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function et(t){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}z="header",(M="className")in(H=J)?Object.defineProperty(H,M,{value:z,enumerable:!0,configurable:!0,writable:!0}):H[M]=z;var nt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&V(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=et(r);if(o){var n=et(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return tt(this,t)});function a(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,t,{name:"Toolbar",listeners:["click"],subscribe:["currentStyles"],options:e})}return e=a,(n=[{key:"prepare",value:function(){this.initState(c)}},{key:"template",get:function(){return'\n      <ul class="toolbar__list">  \n        '.concat((t=[{type:"left",active:"left"==(e=this.state).textAlign,value:{textAlign:"left"}},{type:"center",active:"center"==e.textAlign,value:{textAlign:"center"}},{type:"right",active:"right"==e.textAlign,value:{textAlign:"right"}},{type:"bold",active:"bold"==e.fontWeight,value:{fontWeight:"bold"==e.fontWeight?"normal":"bold"}},{type:"italic",active:"italic"==e.fontStyle,value:{fontStyle:"italic"==e.fontStyle?"normal":"italic"}},{type:"underline",active:"underline"==e.textDecoration,value:{textDecoration:"underline"==e.textDecoration?"none":"underline"}}],this.state,t.map((function(t){var e="data-value=".concat(JSON.stringify(t.value));return'\n    <li class="toolbar__item">\n      <button class="button toolbar__button '.concat(t.active?"active":"",'" id="').concat(t.type,'" ').concat(e,"></button>\n    </li>")})).join("")),"       \n      </ul>\n    ");var t,e}},{key:"onClick",value:function(t){var e=t.target;if(e.classList.contains("button")){var n=JSON.parse(e.dataset.value);this.emit("toolbar:applystyle",n)}}},{key:"toHTML",value:function(){return this.template}},{key:"storeChanged",value:function(t){console.log("changes: ",t),this.setState(t.currentStyles)}}])&&Q(e.prototype,n),a}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&F(t,e)}(c,t);var e,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Z(r);if(o){var n=Z(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return X(this,t)});function c(){Y(this,c);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.call.apply(i,[this].concat(e))}return e=c,(n=[{key:"template",get:function(){return JSON.stringify(this.state,null,2)}},{key:"initState",value:function(t){this.state=K({},t)}},{key:"setState",value:function(t){this.state=K(K({},this.state),t),this._root.html(this.template),w()}}])&&U(e.prototype,n),c}(A));function rt(t){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function it(t,e,n){return(it="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ut(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ct(t,e){return(ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function at(t,e){return!e||"object"!==rt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ut(t){return(ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(nt,"className","toolbar");var lt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ct(t,e)}(a,t);var e,n,o,i,c=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ut(o);if(i){var n=ut(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return at(this,t)});function a(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),c.call(this,t,{name:"formula",listeners:["input","keydown"],subscribe:["currentText"],options:e})}return e=a,(n=[{key:"init",value:function(){var t=this;this._input=this._root._element.querySelector("#formula-input"),it(ut(a.prototype),"init",this).call(this),this.on("cell:click",(function(e){t._input.textContent=e})),this.on("cell:keydown",(function(e){t._input.textContent=e.textContent()}))}},{key:"toHTML",value:function(){return'\n      <div class="formula__info">fx</div>\n      <div class="formula__input" id="formula-input" contenteditable="true" spellcheck="false"></div>\n    '}},{key:"onInput",value:function(t){this.emit("formula:input",r(t.target).textContent())}},{key:"onKeydown",value:function(t){["Enter","Tab"].includes(t.key)&&(t.preventDefault(),this.emit("formula:enter",""))}},{key:"storeChanged",value:function(t){this._input.textContent=t.currentText}}])&&ot(e.prototype,n),a}(A);!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(lt,"className","formula");var st=65;function ft(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return'\n  <div class="table__row" data-parent="parent" data-row='.concat(t," data-lastRow=").concat(n,'>\n    <div class="table__row-info">\n      ').concat(t,"\n      ").concat(t?'<div class="table__resize-row" data-resize="row"></div>':"",'\n    </div>\n    <div class="table__row-data">').concat(e,"</div>\n  </div>\n  ")}function pt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return'\n    <div class="table__column" data-parent="parent" data-col='.concat(t," data-lastCol=").concat(e,">\n      ").concat(t,'\n      <div class="table__resize-col" data-resize="col"></div>\n    </div>\n  ')}function yt(t,e){return String.fromCharCode(t+e)}function bt(t,e){var n=f(c);return"\n    <div class=\"table__cell\" contenteditable='true' style='".concat(n,"' data-col=\"").concat(e,'" data-row="').concat(t,'" data-id="').concat(t).concat(e,'"></div> \n  ')}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var vt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.group=[],this.current=null}var e,n;return e=t,(n=[{key:"select",value:function(e){this._clear(),this.group.push(e),this.current=e,this.current.focus(),e.addClass(t.className),console.log(e.getStyles(Object.keys(c)))}},{key:"selectGroup",value:function(e){this.group.some((function(t){return t.data.id==e.data.id}))?(e.removeClass(t.className),this.group=this.group.filter((function(t){return t.data.id!=e.data.id}))):(this.group.push(e),e.addClass(t.className))}},{key:"selectedIds",get:function(){return this.group.map((function(t){return t.id}))}},{key:"_clear",value:function(){this.group.forEach((function(e){e.removeClass(t.className)})),this.group.length=0}},{key:"applyStyle",value:function(t){this.group.forEach((function(e){e.css(t)}))}}])&&ht(e.prototype,n),t}();!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(vt,"className","selected");var dt="TABLE_SIZE",mt="CHANGE_TEXT",gt="APPLY_STYLE",_t="CHANGE_STYLES";function Ot(t){return{type:mt,data:t}}function wt(t){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function St(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function kt(t,e,n){return(kt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Et(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function jt(t,e){return(jt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pt(t,e){return!e||"object"!==wt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Et(t){return(Et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var xt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jt(t,e)}(u,t);var e,n,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Et(o);if(i){var n=Et(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Pt(this,t)});function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=a.call(this,t,{name:"Table",listeners:["mousedown","click","keydown","input"],options:e}))._root=t,n._tableState=e.tableState,n}return e=u,(n=[{key:"prepare",value:function(){this.selection=new vt}},{key:"init",value:function(){var t=this;kt(Et(u.prototype),"init",this).call(this);var e,n,r=this._root.findElement('[data-id="1A"]');this.selection.select(r),this.on("formula:input",(function(e){t.selection.current.textContent(e),t.dispatch(Ot({value:e,id:t.selection.current.id}))})),this.on("formula:enter",(function(){t.selection.current.focus()})),this.emit("cell:click",this.selection.current.textContent()),e=this.store.getState().tableState,n=this._root._element,Object.keys(e).forEach((function(t){parseInt(t)&&(n.querySelector('[data-row="'.concat(t,'"]')).style.height=e[t]+"px"),parseInt(t)||n.querySelectorAll('[data-col="'.concat(t,'"]')).forEach((function(n){return n.style.width=e[t]+"px"}))})),function(t,e){Object.keys(t).forEach((function(n){e.querySelector('[data-id="'.concat(n,'"]')).textContent=t[n]}))}(this.store.getState().tableText,this._root._element),this.on("toolbar:applystyle",(function(e){t.selection.applyStyle(e),t.dispatch(function(t){return{type:gt,data:t}}({style:e,ids:t.selection.selectedIds}))}))}},{key:"toHTML",value:function(){return function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:31,e=26,n=[],r=0;r<t;++r){var o=[];if(0==r){for(var i=0;i<e;++i)i!=e-1?o.push(pt(yt(st,i))):o.push(pt(yt(st,i),!0));n.push(ft("",o.join("")))}else{for(var c=0;c<e;++c)o.push(bt(r,yt(st,c)));if(r==t-1){n.push(ft(r,o.join(""),!0));continue}n.push(ft(r,o.join("")))}}return n.join("")}()}},{key:"onInput",value:function(t){this.dispatch(Ot({value:t.target.textContent,id:r(t.target).id}))}},{key:"resizeTable",value:function(t){var e,n,r=this;(e=t,n=this._root,new Promise((function(t){var r,o,i=e.target.closest('[data-parent="parent"]'),c=i.getBoundingClientRect(),a="col"==e.target.dataset.resize?"col":"row",u=n.findAll("[data-".concat(a,'="').concat(i.dataset[a],'"]'));"col"==a?e.target.style.height="100vh":e.target.style.width="100vw",document.onmousemove=function(t){r="col"==a?t.clientX:t.clientY,o="col"==a?r-c.x:r-c.y,"col"==a?i.style.width=o+"px":i.style.height=o+"px"},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null,"col"==a?(u.forEach((function(t){t.style.width=o+"px"})),t({id:i.dataset.col,value:~~o})):(i.style.height=o+"px",t({id:i.dataset.row,value:~~o}))}}))).then((function(t){return r.dispatch(function(t){return{type:dt,data:t}}(t))}))}},{key:"onMousedown",value:function(t){var e=t.target;e.dataset.resize&&this.resizeTable(t),e.dataset.id&&(t.shiftKey?this.selection.selectGroup(r(e)):this.selection.select(r(e)))}},{key:"onClick",value:function(t){var e=t.target;if(e.dataset.id){this.emit("cell:click",t.target.textContent);var n=r(e).getStyles(Object.keys(c));console.log("styles for dispatch: ",n),this.dispatch({type:_t,data:n})}}},{key:"onKeydown",value:function(t){if((t.shiftKey||"Tab"==t.key)&&t.preventDefault(),t&&!t.shiftKey){"Enter"==t.key&&t.preventDefault();var e=t.target,n=this._root.findElement('[data-lastrow="true"]')._element.innerText,r=this._root.findElement('[data-lastcol="true"]')._element.innerText,o=this._root.findElement(function(t,e,n,r){var o=e.row,i=e.col;switch(i=i.charCodeAt(i),t){case"Tab":case"ArrowRight":if(i==r.charCodeAt(r))break;++i;break;case"Enter":case"ArrowDown":if(o==n)break;++o;break;case"ArrowLeft":if(65==i)break;--i;break;case"ArrowUp":if(1==o)break;--o}return'[data-id="'.concat(o).concat(String.fromCharCode(i),'"]')}(t.key,e.dataset,n,r));this.selection.select(o),this.emit("cell:keydown",o)}}}])&&St(e.prototype,n),u}(A);function Ct(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Tt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ct(Object(n),!0).forEach((function(e){Rt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Rt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function At(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Dt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?At(Object(n),!0).forEach((function(e){Nt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Nt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(xt,"className","table");var Lt={tableState:{},tableText:{},currentText:"",currentStyles:c,stylesState:{}},Bt=l("table-state")?l("table-state"):Lt,It=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t(Tt({},e),{type:"INIT"}),r=[];return{subscribe:function(t){return r.push(t),{unsubscribe:function(){r=r.filter(listener!=t)}}},dispatch:function(e){n=t(n,e),r.forEach((function(t){return t(n)}))},getState:function(){return n}}}((function(t,e){var n,r=t.tableState||{};switch(e.type){case dt:return r[e.data.id]=e.data.value,Dt(Dt({},t),{},{tableState:r});case mt:var o=t.tableText||{};return o[e.data.id]=e.data.value,Dt(Dt({},t),{},{currentText:e.data.value,tableText:o});case _t:return Dt(Dt({},t),{},{currentStyles:e.data});case gt:var i="stylesState",c=t[i]||{};return e.data.ids.forEach((function(t){c[t]=f(e.style)})),Dt(Dt({},t),{},(Nt(n={},i,c),Nt(n,"currentStyles",Dt(Dt({},t.currentStyles),e.data.style)),n));default:return t}}),l("table-state")||Bt);It.subscribe((function(t){localStorage.setItem("table-state",JSON.stringify(t))})),new h("#app",{components:[J,nt,lt,xt],store:It}).render(),w()})()})();
//# sourceMappingURL=bundle.js.map