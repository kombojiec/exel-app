{"version":3,"sources":["webpack://exel-app/webpack/bootstrap","webpack://exel-app/webpack/runtime/publicPath","webpack://exel-app/./src/core/DomElement.js","webpack://exel-app/./src/core/Observer.js","webpack://exel-app/./src/scripts/constants.js","webpack://exel-app/./src/scripts/utiles.js","webpack://exel-app/./src/core/StoreSubscriber.js","webpack://exel-app/./src/components/exel/Exel.js","webpack://exel-app/./src/scripts/images.js","webpack://exel-app/./src/core/DomListener.js","webpack://exel-app/./src/core/ExelComponent.js","webpack://exel-app/./src/components/header/Header.js","webpack://exel-app/./src/components/toolbar/Toolbar.js","webpack://exel-app/./src/components/toolbar/toolbarTemplate.js","webpack://exel-app/./src/core/ExelStateComponent.js","webpack://exel-app/./src/components/formula/Formula.js","webpack://exel-app/./src/components/table/tableTemplate.js","webpack://exel-app/./src/components/table/TableSelection.js","webpack://exel-app/./src/redux/types.js","webpack://exel-app/./src/redux/actions.js","webpack://exel-app/./src/components/table/Table.js","webpack://exel-app/./src/components/table/tableHandlers.js","webpack://exel-app/./src/redux/initial.state.js","webpack://exel-app/./src/index.js","webpack://exel-app/./src/core/createStore.js","webpack://exel-app/./src/redux/rootReducer.js"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","p","DomElement","selector","this","_element","document","querySelector","data","dataset","id","html","innerHTML","outerHTML","trim","text","textContent","tagName","value","dom","array","Array","from","querySelectorAll","forEach","item","push","className","classList","add","remove","styles","Object","keys","key","style","reduce","res","focus","eventType","callback","addEventListener","removeEventListener","node","append","create","element","createElement","Observer","_listeners","event","filter","listener","initialStyles","textAlign","fontWeight","fontStyle","textDecoration","capitalize","charAt","toUpperCase","slice","storage","JSON","parse","localStorage","getItem","setItem","stringify","camelToCebab","string","replace","toLowerCase","toInlineStyles","map","join","StoreSubscriber","store","sub","prevState","components","getState","subscribe","state","a","b","component","isWatching","changes","storeChanged","unsubscribe","Exel","options","_components","_observer","_store","_tableState","_subscriber","root","componentOptions","observer","Component","rootElement","toHTML","getRoot","subscribeComponents","init","unsubscribeFromStore","destroy","setImages","getElementById","background","bold","italic","underline","left","center","right","DomListener","Error","_root","_name","name","listeners","method","getMethodName","bind","on","off","ExelComponent","prepare","_unsubscribes","includes","emit","action","storeSubscribe","dispatch","initDOMListeners","removeDomListeners","Header","Toolbar","initState","buttons","type","active","button","meta","target","contains","template","console","log","setState","currentStyles","args","initialState","newState","Formula","_input","preventDefault","currentText","CODES","createRow","info","last","createColumn","createChar","start","index","String","fromCharCode","createCell","alpha","TableSelection","group","current","_clear","addClass","getStyles","some","removeClass","length","css","TABLE_SIZE","CHANGE_TEXT","APPLY_STYLE","CHANGE_STYLES","changeTextAction","Table","tableState","selection","table","cell","findElement","select","actions","parseInt","height","width","setTableData","tableText","applyStyle","ids","selectedIds","rowsCount","colsCount","rows","i","cols","j","k","tableTemplate","downEvent","Promise","resolve","position","spread","parent","closest","coords","getBoundingClientRect","resize","cells","findAll","onmousemove","moveEvent","clientX","clientY","x","y","onmouseup","upEvent","col","row","then","resizeTable","shiftKey","selectGroup","lastRow","innerText","lastColumn","nextElement","charCodeAt","keyHandler","defaultState","stylesState","rootReducer","createStore","field","render"],"mappings":"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","file":"bundle.js","sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.p = \"\";","\nclass DomElement{\n  constructor(selector){\n    this._element = typeof selector === 'string'?\n      document.querySelector(selector):\n      selector;\n    this.data = this._element.dataset;\n    this.id = this._element.dataset.id\n  }\n\n  html(html){\n    if(typeof html === 'string'){\n      this._element.innerHTML = html;\n      return this;\n    }\n    return this._element.outerHTML.trim();\n  }\n\n  textContent(text){\n    if(typeof text == 'string'){\n      this._element.textContent = text;\n      return this;\n    }\n    if(this._element.tagName == 'INPUT'){\n      return this._element.value.trim();\n    }\n    return this._element.textContent.trim();\n  }\n\n  findElement(selector){\n    return dom(this._element.querySelector(selector));\n  }\n\n  findAll(selector){\n    const array = [];\n    Array.from(this._element.querySelectorAll(selector))\n      .forEach(item =>{\n        array.push(item);\n      })\n    return array;\n  }\n\n  addClass(className){\n    this._element.classList.add(className);\n    return this;\n  }\n\n  removeClass(className){\n    this._element.classList.remove(className);\n    return this;\n  }\n\n  css(styles = {}){\n    Object.keys(styles).forEach(key => {\n      this._element.style[key] = styles[key];\n    })\n  }\n\n  getStyles(styles = []){\n    return styles.reduce((res, style) => {\n      res[style] = this._element.style[style];\n      return res;\n    }, {});\n  }\n\n  focus(){\n    this._element.focus();\n    return this;\n  }\n\n  clear(){\n    this.html('');\n    return this;\n  }\n\n  on(eventType, callback){\n    this._element.addEventListener(eventType, callback);\n  }\n\n  off(eventType, callback){\n    this._element.removeEventListener(eventType, callback);\n  }\n\n  append(node){\n    if(node instanceof DomElement){\n      node = node._element\n    }\n    this._element.append(node);\n    return this;\n  }\n\n}\n\n\nexport function dom(selector){\n  return new DomElement(selector);\n}\n\ndom.create = (tagName, className) => {\n  const element =  document.createElement(tagName);\n  element.className = className? className: '';\n  return dom(element);\n}\n","export class Observer{\n  constructor(){\n    this._listeners = {};\n  }\n\n  emit(event, ...data){\n    if(!this._listeners[event]){return};\n    this._listeners[event].forEach(callback => {\n      callback(...data);\n    });\n  }\n\n  subscribe(event, callback){\n    this._listeners[event] = this._listeners[event] || [];\n    this._listeners[event].push(callback);\n    return () => {\n      this._listeners[event] = this._listeners[event].filter(listener => listener != callback);\n    }\n  }\n\n}\n\n\n","const initialStyles = {\r\n  textAlign: 'left',\r\n  fontWeight: 'normal',\r\n  fontStyle: 'normal',\r\n  textDecoration: 'none'\r\n}\r\n\r\nexport {initialStyles};","import { initialStyles } from \"./constants\";\n\nexport const capitalize = (value) => {\n  if(typeof value !== 'string'){\n    return '';\n  }\n  return value.charAt(0).toUpperCase() + value.slice(1)\n}\n\nexport function storage(key, value = null){\n  if(value){\n    localStorage.setItem(key, JSON.stringify(value));\n  }else{\n    return JSON.parse(localStorage.getItem(key));\n  }\n}\n\nexport function isEqual(a, b){\n  if(typeof a === 'object' && typeof b === 'object'){\n    return JSON.stringify(a) === JSON.stringify(b);\n  }else{\n    return JSON.stringify(a) === JSON.stringify(b);\n  }\n}\n\nexport function camelToCebab(string){\n  return string.replace(/([a-z0-9])([A-Z])/g, '$1-$2').toLowerCase();\n }\n\nexport function toInlineStyles(styles = {}){\n  return Object.keys(styles)\n    .map(key => `${camelToCebab(key)}: ${styles[key]}`)\n    .join(';');\n}","import { isEqual } from \"../scripts/utiles\";\r\n\r\nexport class StoreSubscriber{\r\n  constructor(store){\r\n    this.store = store;\r\n    this.sub = null;\r\n    this.prevState = {};\r\n  }\r\n\r\n  subscribeComponents(components){\r\n    this.prevState = this.store.getState();\r\n    this.sub = this.store.subscribe(state => {\r\n      Object.keys(state).forEach(key => {\r\n        if(!isEqual(this.prevState[key], state[key])){\r\n          components.forEach(component => {\r\n            if(component.isWatching(key)){\r\n              const changes = {[key]: state[key]};\r\n              component.storeChanged(changes);\r\n            }\r\n          })\r\n        }\r\n      })\r\n      this.prevState = this.store.getState();\r\n    })\r\n  }\r\n\r\n  unsubscribeFromStore(){\r\n    this.sub.unsubscribe();\r\n  }\r\n\r\n}","import {dom} from '../../core/DomElement';\nimport { Observer } from '../../core/Observer';\nimport { StoreSubscriber } from '../../core/StoreSubscriber';\n\nexport class Exel{\n  constructor(selector, options){\n    this._element = dom(selector);\n    this._components = options.components || [];\n    this._observer = new Observer();\n    this._store = options.store;\n    this._tableState = options._tableState;\n    this._subscriber = new StoreSubscriber(this._store)\n  }\n\n  getRoot(){\n    const root = dom.create('div', 'exel');\n    const componentOptions = {\n      observer: this._observer,\n      store: this._store, \n    }\n    this._components = this._components.map(Component => {\n      const rootElement = dom.create('div', Component.className);\n      const component = new Component(rootElement, componentOptions);\n      rootElement.html(component.toHTML());\n      root.append(rootElement);\n      return component;\n    });\n    return root;\n  }\n\n  render(){\n    this._element.append(this.getRoot());\n    this._subscriber.subscribeComponents(this._components)\n    this._components.forEach(element => {\n      element.init();\n    });\n  }\n\n  destroy(){\n    this._subscriber.unsubscribeFromStore();\n    this._components.forEach(component => component.destroy())\n  }\n\n}","import bold from '../images/bold-text.svg'\nimport italic from '../images/italic-text.svg'\nimport underline from '../images/underlined-text.svg'\nimport center from '../images/justification.svg'\nimport left from '../images/left-align.svg'\nimport right from '../images/right-align.svg'\n\nexport const setImages = () =>{\n  document.getElementById('bold').style.background = ` center / 50% no-repeat url(${bold})`;\n  document.getElementById('italic').style.background = ` center / 50% no-repeat url(${italic})`;\n  document.getElementById('underline').style.background = ` center / 50% no-repeat url(${underline})`;\n  document.getElementById('left').style.background = ` center / 50% no-repeat url(${left})`;\n  document.getElementById('center').style.background = ` center / 50% no-repeat url(${center})`;\n  document.getElementById('right').style.background = ` center / 50% no-repeat url(${right})`;\n}\n","import { capitalize } from './../scripts/utiles';\n\nexport class DomListener{\n  constructor(root, options){\n    if(!root){\n      throw new Error('No root provided to DomListener');\n    }\n    this._root = root;\n    this._name = options.name;\n    this._listeners = options.listeners || [];\n    this._observer = options.observer\n  }\n\n  initDOMListeners(){\n    this._listeners.forEach(listener => {\n      const method = getMethodName(capitalize(listener));\n      if(!this[method]){\n        throw new Error(`No method ${method} in ${this._name} Component`)\n      }\n      this[method] = this[method].bind(this)\n      this._root.on(listener, this[method])\n    })\n  }\n\n  removeDomListeners(){\n    this._listeners.forEach(listener => {\n      const method = getMethodName(capitalize(listener))\n      this._root.off(listener, this[method]);\n    })\n  }\n  \n}\n\nconst getMethodName = (method) => {\n  return 'on' + method;\n}","import { DomListener } from \"./DomListener\";\n\n\nexport class ExelComponent extends DomListener{\n\n  constructor(root, options = {}){\n    super(root, options)\n    this.prepare();\n    this.observer = options.options.observer;\n    this._unsubscribes = [];\n    this.store = options.options.store;\n    this.subscribe = options.subscribe || [];\n  }\n\n  prepare(){}\n\n  storeChanged(){}\n\n  isWatching(key){\n    return this.subscribe.includes(key);\n  }\n\n  emit(event, ...data){\n    this.observer.emit(event, ...data);\n  }\n\n  on(event, callback){\n    const unsubscribe = this.observer.subscribe(event, callback);\n    this._unsubscribes.push(unsubscribe);\n  }\n\n  dispatch(action){\n    this.storeSubscribe = this.store.dispatch(action);\n  }\n\n  // Возврат HTML структуры компонента\n  toHTML(){\n    return '';\n  }\n\n  init(){\n    this.initDOMListeners();\n  }\n\n  destroy(){\n    this.removeDomListeners();\n    this._unsubscribes.forEach(subscribe => subscribe());\n  }\n\n}","\nimport { ExelComponent } from './../../core/ExelComponent';\n\nexport class Header extends ExelComponent{\n  static className = 'header';\n\n  constructor(root, options){\n    super(root, {\n      name: 'Header',\n      listeners: [],\n      options\n    })\n  }\n\n  toHTML(){\n    return `\n    <input type=\"text\" class=\"header__input\" value=\"Новая таблица\">\n    <div class=\"header__buttons\">\n      <button class=\"button header-button\">Удалить</button>\n      <button class=\"button header-button\">Выйти</button>\n    </div>\n    `;\n  }\n\n}","import { ExelStateComponent } from '../../core/ExelStateComponent';\nimport { initialStyles } from '../../scripts/constants';\nimport { createToolbar, buttonsState } from './toolbarTemplate';\n\nexport class Toolbar extends ExelStateComponent{\n  static className = 'toolbar';\n\n  constructor(root, options){\n    super(root, {\n      name: 'Toolbar',\n      listeners: ['click'],\n      subscribe: ['currentStyles'],\n      options\n    })\n  }\n\n  prepare(){\n    this.initState(initialStyles)\n  }\n\n  get template(){\n    return `\n      <ul class=\"toolbar__list\">  \n        ${createToolbar(buttonsState(this.state), this.state)}       \n      </ul>\n    `\n  }\n\n  onClick(event){\n    const target = event.target;\n    if(target.classList.contains('button')){\n      const value = JSON.parse(target.dataset.value);\n      // const key = Object.keys(value)[0];\n      // this.setstate({[key]: value[key]})\n      this.emit('toolbar:applystyle', value)\n    }\n  }\n  \n  toHTML(){\n    return this.template\n  }\n\n  storeChanged(changes){\n    console.log('changes: ', changes);\n    this.setState(changes.currentStyles)\n  }\n\n  \n\n}","export function createToolbar(buttons, state){\r\n  return buttons.map(button => {\r\n    const meta = `data-value=${JSON.stringify(button.value)}`\r\n    return `\r\n    <li class=\"toolbar__item\">\r\n      <button class=\"button toolbar__button ${button.active? 'active': ''}\" id=\"${button.type}\" ${meta}></button>\r\n    </li>`\r\n  }).join('');\r\n}\r\n\r\nexport function buttonsState(state){\r\n  return [\r\n    {\r\n      type: \"left\",\r\n      active: state['textAlign'] == 'left',\r\n      value: {\r\n        'textAlign': 'left'\r\n      }\r\n    }, \r\n    {\r\n      type: \"center\",\r\n      active: state['textAlign'] == 'center',\r\n      value: {\r\n        'textAlign': 'center'\r\n      }\r\n    }, \r\n    {\r\n      type: \"right\",\r\n      active: state['textAlign'] == 'right',\r\n      value: {\r\n        'textAlign': 'right'\r\n      }\r\n    }, \r\n    {\r\n      type: \"bold\",\r\n      active: state['fontWeight'] == 'bold',\r\n      value: {\r\n        'fontWeight': state['fontWeight'] == 'bold'? 'normal': 'bold'\r\n      }\r\n    }, \r\n    {\r\n      type: \"italic\",\r\n      active: state['fontStyle'] == 'italic',\r\n      value: {\r\n        'fontStyle': state['fontStyle'] == 'italic'? 'normal': 'italic'\r\n      }\r\n    }, \r\n    {\r\n      type: \"underline\",\r\n      active: state['textDecoration'] == 'underline',\r\n      value: {\r\n        'textDecoration': state['textDecoration'] == 'underline'? 'none': 'underline'\r\n      }\r\n    }\r\n  ]\r\n}\r\n\r\n","import { setImages } from \"../scripts/images\";\r\nimport { ExelComponent } from \"./ExelComponent\";\r\n\r\nexport class ExelStateComponent extends ExelComponent{\r\n  constructor(...args){\r\n    super(...args);    \r\n  }\r\n\r\n  get template(){\r\n    return JSON.stringify(this.state, null, 2)\r\n  }\r\n\r\n  initState(initialState){\r\n    this.state = {...initialState};\r\n  }\r\n\r\n  setState(newState){\r\n    this.state = {...this.state, ...newState}\r\n    this._root.html(this.template)\r\n    setImages();\r\n  }\r\n\r\n}","\nimport { ExelComponent } from '../../core/ExelComponent';\nimport {dom} from '../../core/DomElement';\n\nexport class Formula extends ExelComponent{\n  static className = 'formula';\n\n  constructor(root, options){\n    super(root, {\n      name: 'formula',\n      listeners: ['input', 'keydown'],\n      subscribe: ['currentText'],\n      options\n    });\n  }  \n  \n  init(){\n    this._input = this._root._element.querySelector(\"#formula-input\");\n    super.init();\n    this.on('cell:click', data => {\n      this._input.textContent = data;\n    })\n    this.on('cell:keydown', data => {\n      this._input.textContent = data.textContent();\n    })\n  }\n\n  toHTML(){\n    return `\n      <div class=\"formula__info\">fx</div>\n      <div class=\"formula__input\" id=\"formula-input\" contenteditable=\"true\" spellcheck=\"false\"></div>\n    `;\n  }\n\n  onInput(event){\n    this.emit('formula:input', dom(event.target).textContent())\n  }\n\n  onKeydown(event){\n    const keys = ['Enter', 'Tab']\n    if(keys.includes(event.key)){\n      event.preventDefault();\n      this.emit('formula:enter', '');\n    }\n  }\n\n  storeChanged(changes){\n    this._input.textContent =  changes.currentText;\n  }\n\n}","import { initialStyles } from \"../../scripts/constants\"\nimport { toInlineStyles } from \"../../scripts/utiles\"\n\nconst CODES = {\n  A: 65,\n  Z: 90\n}\n\nfunction createRow(info, data, last = false){\n  return `\n  <div class=\"table__row\" data-parent=\"parent\" data-row=${info} data-lastRow=${last}>\n    <div class=\"table__row-info\">\n      ${info}\n      ${info? '<div class=\"table__resize-row\" data-resize=\"row\"></div>': ''}\n    </div>\n    <div class=\"table__row-data\">${data}</div>\n  </div>\n  `\n}\n\nfunction createColumn(value = '', last = false){\n  return `\n    <div class=\"table__column\" data-parent=\"parent\" data-col=${value} data-lastCol=${last}>\n      ${value}\n      <div class=\"table__resize-col\" data-resize=\"col\"></div>\n    </div>\n  `\n}\n\nfunction createChar(start, index){\n  return String.fromCharCode(start + index)\n}\n\nfunction createCell(index, alpha){\n  const styles = toInlineStyles(initialStyles)\n  return `\n    <div class=\"table__cell\" contenteditable='true' style='${styles}' data-col=\"${alpha}\" data-row=\"${index}\" data-id=\"${index}${alpha}\"></div> \n  `\n}\n\nexport const tableTemplate = (rowsCount = 31) => {\n  const colsCount = CODES.Z - CODES.A + 1;\n  const rows = [];\n  for(let i = 0; i < rowsCount; ++i){\n    const cols = [];\n    if(i == 0){\n      for(let j = 0; j < colsCount; ++j){\n        if(j == colsCount - 1){\n          cols.push(createColumn(createChar(CODES.A, j), true));\n          continue;\n        }\n        cols.push(createColumn(createChar(CODES.A, j)));\n      }\n      rows.push(createRow('', cols.join('')));\n    }else{\n      for(let k = 0; k < colsCount; ++k){\n        cols.push(createCell(i, createChar(CODES.A, k)));\n      }\n      if(i == rowsCount - 1){\n        rows.push(createRow(i, cols.join(''), true));\n        continue;\n      }\n      rows.push(createRow(i, cols.join('')))\n    }\n  }\n\n  return rows.join('');\n}","import { initialStyles } from \"../../scripts/constants\";\n\nexport class TableSelection{\n  static className = 'selected';\n\n  constructor(){\n    this.group = []\n    this.current = null;\n  }\n\n  select(element){\n    this._clear();\n    this.group.push(element);\n    this.current = element;\n    this.current.focus();\n    element.addClass(TableSelection.className);\n    console.log(element.getStyles(Object.keys(initialStyles)))\n  }\n\n  selectGroup(element){\n    if(this.group.some(item => item.data.id == element.data.id)){\n      element.removeClass(TableSelection.className);\n      this.group = this.group.filter(item => item.data.id != element.data.id);\n    }else{\n      this.group.push(element);\n      element.addClass(TableSelection.className);    \n    }\n  }\n\n  get selectedIds(){\n    return this.group.map(element => element.id);\n  }\n\n  _clear(){\n    this.group.forEach(element => {\n      element.removeClass(TableSelection.className);\n    })\n    this.group.length = 0;\n  }\n\n  applyStyle(styles){\n    this.group.forEach(element => {\n      element.css(styles);\n    })\n  }\n\n}","const TABLE_SIZE = 'TABLE_SIZE';\r\nconst CHANGE_TEXT = 'CHANGE_TEXT';\r\nconst APPLY_STYLE = 'APPLY_STYLE';\r\nconst CHANGE_STYLES = 'CHANGE_STYLES';\r\n\r\nexport {TABLE_SIZE, CHANGE_TEXT, APPLY_STYLE, CHANGE_STYLES}","import {TABLE_SIZE, CHANGE_TEXT, CHANGE_STYLES, APPLY_STYLE} from './types';\r\n\r\nfunction tableResizeAction(data){\r\n  return {\r\n    type: TABLE_SIZE,\r\n    data\r\n  }\r\n}\r\n\r\nfunction changeTextAction(data){\r\n  return {\r\n    type: CHANGE_TEXT,\r\n    data\r\n  }\r\n}\r\n\r\nfunction changeStylesAction(data){\r\n  return {\r\n    type: CHANGE_STYLES,\r\n    data\r\n  }\r\n}\r\n\r\nfunction applyStyleAction(data){\r\n  return {\r\n    type: APPLY_STYLE,\r\n    data\r\n  }\r\n}\r\n\r\nexport {tableResizeAction, changeTextAction, changeStylesAction, applyStyleAction}","import { ExelComponent } from '../../core/ExelComponent';\nimport { tableTemplate } from './tableTemplate';\nimport {dom} from '../../core/DomElement';\nimport {resizeHandler, keyHandler, setTableSize, setTableData} from './tableHandlers';\nimport { TableSelection } from './TableSelection';\nimport * as actions from '../../redux/actions';\nimport { initialStyles } from '../../scripts/constants';\n\nexport class Table extends ExelComponent{\n  static className = 'table';\n\n  constructor(root, options){\n    super(root, {\n      name: 'Table',\n      listeners: ['mousedown', 'click', 'keydown', 'input'],\n      options\n    })\n    this._root = root;\n    this._tableState = options.tableState\n  }\n\n  prepare(){\n    this.selection = new TableSelection();\n  }\n\n  init(){\n    super.init();\n    const cell = this._root.findElement('[data-id=\"1A\"]');\n    this.selection.select(cell);\n    this.on('formula:input', data => {\n      this.selection.current.textContent(data)\n      this.dispatch(actions.changeTextAction({\n        value: data,\n        id:this.selection.current.id\n      }))\n\n    })\n    this.on('formula:enter', () => {\n      this.selection.current.focus();\n    })\n    this.emit('cell:click', this.selection.current.textContent())\n    setTableSize(this.store.getState().tableState, this._root._element);\n    setTableData(this.store.getState().tableText, this._root._element);\n\n    this.on('toolbar:applystyle', style => {\n      this.selection.applyStyle(style);\n      this.dispatch((actions.applyStyleAction({\n        style,\n        ids: this.selection.selectedIds\n      })))\n    })\n\n  }\n  \n  toHTML(){\n    return tableTemplate();\n  }\n\n  onInput(event){\n    this.dispatch(actions.changeTextAction({\n      value: event.target.textContent,\n      id:dom(event.target).id\n    }))    \n  }\n\n  resizeTable(event){\n    resizeHandler(event, this._root)\n    .then(data => this.dispatch(actions.tableResizeAction(data)))    \n  }\n\n  onMousedown(downEvent){\n    const target = downEvent.target;\n    if(target.dataset.resize){\n      this.resizeTable(downEvent)      \n    }\n\n    if(target.dataset.id){\n      if(downEvent.shiftKey){\n        this.selection.selectGroup(dom(target));\n      }else{\n        this.selection.select(dom(target));\n      }\n    }\n  }\n\n  onClick(event){\n    const target = event.target\n    if(target.dataset.id){\n      this.emit('cell:click', event.target.textContent);\n      const styles = (dom(target).getStyles(Object.keys(initialStyles)));\n      console.log('styles for dispatch: ', styles)\n      this.dispatch(actions.changeStylesAction(styles))\n    }\n  }\n\n  onKeydown(event){\n    if(event.shiftKey || event.key == 'Tab'){\n      event.preventDefault();\n    }\n    if(event && !event.shiftKey){\n      if(event.key == 'Enter'){\n        event.preventDefault();\n      }\n      const target = event.target;\n      const lastRow = this._root.findElement('[data-lastrow=\"true\"]')._element.innerText;\n      const lastColumn = this._root.findElement('[data-lastcol=\"true\"]')._element.innerText;\n      const nextElement = this._root.findElement(keyHandler(event.key, target.dataset, lastRow, lastColumn));\n      this.selection.select(nextElement);\n      this.emit('cell:keydown', nextElement)\n    }\n  }\n\n}\n","\nexport function resizeHandler(downEvent, root){\n  return new Promise(resolve => {\n\n    const parent = downEvent.target.closest('[data-parent=\"parent\"]');\n    const coords = parent.getBoundingClientRect();\n    let target = downEvent.target.dataset.resize == 'col'? 'col': 'row';\n    const cells = root.findAll(`[data-${target}=\"${parent.dataset[target]}\"]`) \n    let position;\n    let spread;\n    \n    if(target == 'col'){\n      downEvent.target.style.height = 100 + 'vh';\n    }else{\n      downEvent.target.style.width = 100 + 'vw';\n    }\n    \n    document.onmousemove = moveEvent => {\n      position = target == 'col'? moveEvent.clientX: moveEvent.clientY;\n      spread =  target == 'col'? position - coords.x: position - coords.y;\n      target == 'col'? parent.style.width = spread + 'px': parent.style.height = spread + 'px';\n      \n    }\n    \n    document.onmouseup = upEvent => {\n      document.onmousemove = null;\n      document.onmouseup = null;\n\n      if(target == 'col'){\n        cells.forEach(cell => {\n          cell.style.width = spread + `px`;\n        })\n        resolve({\n          id: parent.dataset.col,\n          value: ~~spread,\n        })\n      }else{\n        parent.style.height = spread + `px`;\n        resolve({\n          id: parent.dataset.row,\n          value: ~~spread,\n        })\n      }\n\n    }\n\n  })\n}\n\nexport function keyHandler(key, data, lastRow, lastColumn){\n  let {row, col} = data;\n  col = col.charCodeAt(col)\n  switch(key){\n    case 'Tab':\n    case 'ArrowRight':\n      if(col == lastColumn.charCodeAt(lastColumn)){\n        break\n      };\n      ++col;\n      break;\n    case 'Enter':\n    case 'ArrowDown':\n      if(row == lastRow){\n        break;\n      }\n      ++row;\n      break;\n    case 'ArrowLeft':\n      if(col == 65){\n        break\n      };\n      --col;\n      break;\n    case 'ArrowUp':\n      if(row == 1){\n        break\n      }\n      --row;\n      break;\n  }\n  return `[data-id=\"${row}${String.fromCharCode(col)}\"]`;\n}\n\nexport function setTableSize(data, table){\n  Object.keys(data).forEach(key => {\n    if(parseInt(key)){\n      const cell = table.querySelector(`[data-row=\"${key}\"]`);\n      cell.style.height = data[key] + 'px';\n    }\n    if(!parseInt(key)){\n      const cells = table.querySelectorAll(`[data-col=\"${key}\"]`);\n      cells.forEach(cell => cell.style.width = data[key] + 'px');\n    }\n  })\n}\n\nexport function setTableData(data, table){\n  Object.keys(data).forEach(key => {\n    table.querySelector(`[data-id=\"${key}\"]`).textContent = data[key];\n  })\n}\n\n","import { initialStyles } from \"../scripts/constants\"\r\nimport { storage } from \"../scripts/utiles\"\r\n\r\n\r\nconst defaultState = {\r\n  tableState: {},\r\n  tableText: {},\r\n  currentText: '',\r\n  currentStyles: initialStyles,\r\n  stylesState: {},\r\n}\r\n\r\nexport const initialState = storage('table-state')? storage('table-state'): defaultState","import './index.css';\nimport { Exel } from './components/exel/Exel';\nimport {setImages} from './scripts/images';\nimport { Header } from './components/header/Header';\nimport { Toolbar } from './components/toolbar/Toolbar';\nimport { Formula } from './components/formula/Formula';\nimport { Table } from './components/table/Table';\nimport { createStore } from './core/createStore';\nimport { rootReducer } from './redux/rootReducer';\nimport { storage } from './scripts/utiles';\nimport { initialState } from './redux/initial.state';\n\nconst store = createStore(rootReducer, storage('table-state') || initialState);\n\nstore.subscribe(data => {\n  localStorage.setItem('table-state', JSON.stringify(data))\n})\nconst exel = new Exel('#app', {\n  components: [Header, Toolbar, Formula, Table],\n  store, \n});\n exel.render();\n setImages();\n\n","export function createStore(rootReducer, initialState = {}){\r\n\r\n  let state = rootReducer({...initialState}, {type: 'INIT'});\r\n  let listeners = [];\r\n\r\n  return {\r\n    subscribe(callback){\r\n      listeners.push(callback);\r\n      return {\r\n        unsubscribe(){\r\n          listeners = listeners.filter(listener != callback);\r\n        }\r\n      }\r\n    },\r\n\r\n    dispatch(action){\r\n      state = rootReducer(state, action)\r\n      listeners.forEach(listener => listener(state))\r\n    },\r\n\r\n    getState(){\r\n      return state;\r\n    }\r\n  }\r\n}","import { toInlineStyles } from '../scripts/utiles';\r\nimport {CHANGE_TEXT, TABLE_SIZE, CHANGE_STYLES, APPLY_STYLE} from './types';\r\n\r\nexport function rootReducer(state, action){\r\n\r\n  let prevState = state.tableState || {};\r\n  \r\n  switch(action.type){\r\n\r\n    case TABLE_SIZE:\r\n      prevState[action.data.id] = action.data.value;\r\n      return {...state, tableState: prevState} // id + value\r\n    \r\n    case CHANGE_TEXT:\r\n      const data = state.tableText || {};\r\n      data[action.data.id] = action.data.value;\r\n      return {...state, currentText: action.data.value, tableText: data}\r\n\r\n    case CHANGE_STYLES:\r\n      return {...state, currentStyles: action.data}\r\n\r\n      case APPLY_STYLE:\r\n        const field = 'stylesState'\r\n        const value = state[field] || {};\r\n        action.data.ids.forEach(id => {\r\n          value[id] = toInlineStyles(action.style)\r\n        })\r\n      return {\r\n        ...state, \r\n        [field]: value, \r\n        currentStyles: {...state.currentStyles, ...action.data.style}\r\n      }\r\n\r\n    default: return state;\r\n\r\n  }\r\n}"],"sourceRoot":""}